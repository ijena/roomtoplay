<!DOCTYPE html>
<html>
<head>
  <title>Game Lobby</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 60px; }
    #hostControls { margin-top: 30px; display: none; }
    #promptDisplay { margin-top: 30px; font-size: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>üïµÔ∏è Game Lobby</h1>
  <p id="roomInfo"></p>

  <div id="hostControls">
    <button onclick="startRound()">‚ñ∂Ô∏è Start Round</button>
  </div>

  <div id="promptDisplay"></div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io("/impostor");

    const name = localStorage.getItem("playerName");
    const roomCode = localStorage.getItem("roomCode");

    if (!name || !roomCode) {
      alert("Missing player info. Go back and re-enter.");
      location.href = "index.html";
    }

    document.getElementById("roomInfo").innerText =
      `Welcome ${name} ‚Äî Room Code: ${roomCode}`;

    // Rejoin logic (triggers host check server-side)
    socket.emit("rejoin-room", { playerName: name, roomCode });

    socket.on("prompt", ({ prompt }) => {
      document.getElementById("promptDisplay").innerText = `Your prompt: ${prompt}`;
    });

    socket.on("host-assigned", ({ message }) => {
      document.getElementById("hostControls").style.display = "block";
      console.log(message);
    });

    socket.on("joined-room", () => {
      console.log("Joined room successfully.");
    });

    socket.on("error", (msg) => {
      alert("‚ùå " + msg);
    });

    function startRound() {
      socket.emit("start-round");
    }
  </script>
</body>
</html>
